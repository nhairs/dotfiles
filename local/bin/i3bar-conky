#!/bin/bash

#echo "{\"version\":1}"
echo "{ \"version\": 1, \"stop_signal\": 10, \"cont_signal\": 12, \"click_events\": true }"
echo "[[]"
conky -d

IFS="}"
while read;do
  IFS=" "
  STR=`echo $REPLY | sed -e s/[{}]//g -e "s/ \"/\"/g" | awk '{n=split($0,a,","); for (i=1; i<=n; i++) {m=split(a[i],b,":"); if (b[1] == "\"name\"") {NAME=b[2]} if (b[1] =="\"x\"") {X=b[2]} if (b[1] =="\"y\"") {Y=b[2]} } print NAME " " X " " Y}'`
  read NAME X Y <<< $STR
  X=$(($X-50))
  case "${NAME}" in
    \"network\")
        if [[ -e $HOME/.i3/detailed_network ]]; then
            rm $HOME/.i3/detailed_network
        else
            touch $HOME/.i3/detailed_network
        fi
        killall -SIGUSR1 conky
      ;;
    \"time\")
        if [[ -e $HOME/.i3/full_time ]]; then
            rm $HOME/.i3/full_time
        else
            touch $HOME/.i3/full_time
        fi
        killall -SIGUSR1 conky
        ;;
    \"battery\")
        if [[ -e $HOME/.i3/full_battery ]]; then
            rm $HOME/.i3/full_battery
        else
            touch $HOME/.i3/full_battery
        fi
        killall -SIGUSR1 conky
        ;;
    *)
      ;;
  esac
  IFS="}"
done
